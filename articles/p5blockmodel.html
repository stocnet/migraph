<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Practical 5 • migraph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Practical 5">
<meta property="og:description" content="migraph">
<meta property="og:image" content="https://snlab-ch.github.io/migraph/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">migraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/p1data.html">Practical 1</a>
    </li>
    <li>
      <a href="../articles/p2visualisation.html">Practical 2</a>
    </li>
    <li>
      <a href="../articles/p3centrality.html">Practical 3</a>
    </li>
    <li>
      <a href="../articles/p4community.html">Practical 4</a>
    </li>
    <li>
      <a href="../articles/p5blockmodel.html">Practical 5</a>
    </li>
    <li>
      <a href="../articles/p7linearmodel.html">Practical 7</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/snlab-ch/migraph" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p5blockmodel_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Practical 5</h1>
                        <h4 data-toc-skip class="author">James Hollway</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/snlab-ch/migraph/blob/HEAD/vignettes/p5blockmodel.Rmd" class="external-link"><code>vignettes/p5blockmodel.Rmd</code></a></small>
      <div class="hidden name"><code>p5blockmodel.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="setting-up">Setting up<a class="anchor" aria-label="anchor" href="#setting-up"></a>
</h2>
<p>For this lab, we’ll use a few different packages for data and analysis. We’re going to use the <code>ison_algebra</code> dataset again, directly from the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a></span><span class="op">)</span><span class="op">)</span> <span class="co"># note that you may need a special version for what follows...</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ison_algebra"</span>, package <span class="op">=</span> <span class="st">"migraph"</span><span class="op">)</span></code></pre></div>
<p>The network is anonymous, but I think it would be nice to add some names, even if it’s just pretend. Luckily, I’ve added a function for this. This makes plotting the network just a wee bit more accessible:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ison_algebra</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/to.html">to_named</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/addingnames-1.png" width="700"></p>
<p>There are actually three different types of tie here. Let’s separate them out into separate networks.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">m182_friend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/to.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"friend_tie"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 16 nodes and 62 edges</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # A directed simple graph with 3 components</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span class="co">#&gt;   name    </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Franklin</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Alex    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Alton   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bert    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Wesley  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Julius  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 10 more rows</span></span>
<span class="co">#&gt; <span style="color: #949494;">#</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Edge Data: 62 × 3</span></span>
<span class="co">#&gt;    from    to weight</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2     1      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     2     7      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     2     8      1</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 59 more rows</span></span>
<span class="va">gfriend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_friend</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Friendship"</span><span class="op">)</span>
<span class="op">(</span><span class="va">m182_social</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/to.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"social_tie"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 16 nodes and 129 edges</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # A directed simple graph with 1 component</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span class="co">#&gt;   name    </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Franklin</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Alex    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Alton   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bert    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Wesley  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Julius  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 10 more rows</span></span>
<span class="co">#&gt; <span style="color: #949494;">#</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Edge Data: 129 × 3</span></span>
<span class="co">#&gt;    from    to weight</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     5   1.2 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     8   0.15</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     9   2.85</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 126 more rows</span></span>
<span class="va">gsocial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_social</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Social"</span><span class="op">)</span>
<span class="op">(</span><span class="va">m182_task</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/to.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"task_tie"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 16 nodes and 88 edges</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # A directed simple graph with 1 component</span></span>
<span class="co"><span style="color: #949494;">#&gt; #</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span class="co">#&gt;   name    </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Franklin</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Alex    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Alton   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Bert    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Wesley  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Julius  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 10 more rows</span></span>
<span class="co">#&gt; <span style="color: #949494;">#</span></span>
<span class="co"><span style="color: #949494;">#&gt; # Edge Data: 88 × 3</span></span>
<span class="co">#&gt;    from    to weight</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     5    0.3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     9    0.3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1    10    0.3</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 85 more rows</span></span>
<span class="va">gtask</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_task</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Task"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>
<span class="va">gfriend</span> <span class="op">+</span> <span class="va">gsocial</span> <span class="op">+</span> <span class="va">gtask</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/separatingnets-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="structural-holes-and-constraint">Structural Holes and Constraint<a class="anchor" aria-label="anchor" href="#structural-holes-and-constraint"></a>
</h2>
<p>Where might innovation be most likely to occur in these networks? Let’s take a look at which actors are least constrained by their position in the task network to begin with. <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> makes this easy enough with the <code><a href="../reference/node_constraint.html">node_constraint()</a></code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/node_constraint.html">node_constraint</a></span><span class="op">(</span><span class="va">m182_task</span><span class="op">)</span>
<span class="co">#&gt;    Franklin        Alex       Alton        Bert      Wesley      Julius </span>
<span class="co">#&gt; 0.930       0.877       0.664       0.987       0.611       0.609       </span>
<span class="co">#&gt;             </span>
<span class="co">#&gt; + 10 others</span></code></pre></div>
<p>We see that this function returns a vector of constraint scores that can range between 0 and 1. Let’s size the nodes according to this score, and identify the node with the minimum constraint score.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/defunct.html">ggidentify</a></span><span class="op">(</span><span class="va">m182_task</span>, <span class="va">node_constraint</span>, <span class="va">min</span><span class="op">)</span>
<span class="co">#&gt; Warning: This function has been included in the `autographr()` function. Please</span>
<span class="co">#&gt; run `autographr(object, node_measure, identify_function)` instead.</span>
<span class="co">#&gt; Using `stress` as default layout</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/constraintplot-1.png" width="700"></p>
<p>Why minimum? And what can we learn from this plot about where innovation might occur within this network?</p>
</div>
<div class="section level2">
<h2 id="structural-equivalence">Structural Equivalence<a class="anchor" aria-label="anchor" href="#structural-equivalence"></a>
</h2>
<p>Now we are going to identify and interpret the roles or relations between a set of structurally equivalent positions. We’re going to identify structurally equivalent positions across all the data that we have, including ‘task’, ‘social’ and ‘friend’ ties, but the unit test this week will ask you to run this on a uniplex version of this network.</p>
<div class="section level3">
<h3 id="constructing-a-multiplex-matrix">Constructing a multiplex matrix<a class="anchor" aria-label="anchor" href="#constructing-a-multiplex-matrix"></a>
</h3>
<p>Ok, so to begin with we need to obtain the profiles that we are going to correlate to identify same/similar positions. For structural equivalence, we can start with a census of all the outgoing and incoming ties to reveal their tie partners.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/census.html">node_tie_census</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 16 96</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">structural_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/census.html">node_tie_census</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">17</span>,<span class="fl">33</span>,<span class="fl">49</span>,<span class="fl">65</span>,<span class="fl">81</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;          fromFranklin toFranklin fromFranklin toFranklin fromFranklin</span>
<span class="co">#&gt; Franklin            0          0          0.0        0.0          0.0</span>
<span class="co">#&gt; Alex                0          1          0.0        0.0          0.0</span>
<span class="co">#&gt; Alton               0          0          0.0        0.0          0.0</span>
<span class="co">#&gt; Bert                0          0          0.0        0.0          0.0</span>
<span class="co">#&gt; Wesley              0          1          1.2        1.2          0.3</span>
<span class="co">#&gt; Julius              0          1          0.0        0.0          0.0</span>
<span class="co">#&gt;          toFranklin</span>
<span class="co">#&gt; Franklin        0.0</span>
<span class="co">#&gt; Alex            0.0</span>
<span class="co">#&gt; Alton           0.0</span>
<span class="co">#&gt; Bert            0.0</span>
<span class="co">#&gt; Wesley          0.3</span>
<span class="co">#&gt; Julius          0.0</span></code></pre></div>
<p>We can see that the result is a matrix of 16 rows and 96 columns, because we want to catalogue or take a census of all the different incoming/outgoing partners our 16 nodes might have across these three networks. Note also that the result is a weighted matrix; what would you do if you wanted it to be binary?</p>
</div>
<div class="section level3">
<h3 id="calculating-structural-dissimilarity">Calculating structural (dis)similarity<a class="anchor" aria-label="anchor" href="#calculating-structural-dissimilarity"></a>
</h3>
<p>The next step, once we have our data (the tie census), is to cluster nodes by their equivalence. In summary, we’re going to hierarchically cluster the nodes based on the distances in dissimilarity in their outgoing and incoming ties. Or you can just run the following line:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">str_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; stats::hclust(d = distances)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster method   : complete </span>
<span class="co">#&gt; Number of objects: 16</span></code></pre></div>
<p>This object doesn’t tell us much, but we can investigate it more using <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>’s <code><a href="../reference/blockmodel_vis.html">ggtree()</a></code>. This is a dendrogram of the hierarchical clustering object. Basically, as we move to the right, we’re allowing for more and more dissimilarity among those we cluster together. A fork or branching point indicates the level of dissimilarity at which those two or more nodes would be said to be equivalent.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggtree</a></span><span class="op">(</span><span class="va">str_res</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggtree</a></span><span class="op">(</span><span class="va">str_res</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># for example let's say there are just two main clusters</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggtree</a></span><span class="op">(</span><span class="va">str_res</span>, <span class="fl">4</span><span class="op">)</span> <span class="co"># or four? what are we seeing here?</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<p>Ok, so we can draw a line and this establishes how many clusters we have (or vice versa), but also which nodes belong to which cluster. But how many clusters should we pick?</p>
</div>
<div class="section level3">
<h3 id="identifying-number-of-clusters">Identifying number of clusters<a class="anchor" aria-label="anchor" href="#identifying-number-of-clusters"></a>
</h3>
<p>To establish that, we need to iterate through all of our options, calculating for each how correlated this pattern is with the observed network. We then plot this and, using the “elbow method”, decide how many clusters.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggidentify_clusters</a></span><span class="op">(</span><span class="va">str_res</span>, <span class="va">structural_combo</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/idstrclust-1.png" width="700"></p>
<p>When there is one cluster for each vertex in the network, cell values will be identical to the observed correlation matrix, and when there is one cluster for the whole network, the values will all be equal to the average correlation across the observed matrix. So the correlations in each by-cluster matrix are correlated with the observed correlation matrix to see how well each by-cluster matrix fits the data.</p>
<p>Ok, so it looks here as if there is a clear bend in the elbow/knee at four clusters. This is reasonably parsimonious and well-fitting. More clusters than this only distinguishes nodes that are less dissimilar.</p>
<p>We can use <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree()</a></code> to cut the tree at our desired point and return the resulting vector of cluster assignments.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">str_clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">str_res</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Franklin     Alex    Alton     Bert   Wesley   Julius    Traci   Hannah </span>
<span class="co">#&gt;        1        2        3        1        3        3        2        2 </span>
<span class="co">#&gt;  Bethany     Lula     Noah    Ronda   Collin  Kristie  Tabitha Michelle </span>
<span class="co">#&gt;        1        1        3        1        2        2        1        4</span></code></pre></div>
<p>This we can use for various things. Most immediately, we may wish to see these cluster assignments mapped onto our networks. All we need to do is add the variable to existing networks and plot them:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m182_task</span> <span class="op">&lt;-</span> <span class="va">m182_task</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/coercion.html">as_tidygraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>clu <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_task</span>, node_color <span class="op">=</span> <span class="st">"clu"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Task"</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strclu-plots-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m182_social</span> <span class="op">&lt;-</span> <span class="va">m182_social</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/coercion.html">as_tidygraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>clu <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_social</span>, node_color <span class="op">=</span> <span class="st">"clu"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Social"</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strclu-plots-2.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m182_friend</span> <span class="op">&lt;-</span> <span class="va">m182_friend</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/coercion.html">as_tidygraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>clu <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_friend</span>, node_color <span class="op">=</span> <span class="st">"clu"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Friend"</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strclu-plots-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="blockmodelling">Blockmodelling<a class="anchor" aria-label="anchor" href="#blockmodelling"></a>
</h3>
<p>Now we can use the 4-cluster solution to generate blockmodels. We’ll do this on the valued network, but binary is possible too.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">task_blockmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">blockmodel</a></span><span class="op">(</span><span class="va">m182_task</span>, <span class="va">str_clu</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Network Blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Block membership:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Franklin    Traci    Ronda     Alex   Collin  Kristie   Hannah  Bethany </span>
<span class="co">#&gt;        1        2        3        1        3        3        2        2 </span>
<span class="co">#&gt;    Alton     Bert  Tabitha   Wesley     Lula     Noah   Julius Michelle </span>
<span class="co">#&gt;        1        1        3        1        2        2        1        4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Reduced form blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Franklin Alex Alton Bert Wesley Julius Traci Hannah Bethany Lula Noah Ronda Collin Kristie Tabitha Michelle </span>
<span class="co">#&gt;         Block 1 Block 2 Block 3 Block 4</span>
<span class="co">#&gt; Block 1 0.36000  0.0000  0.0250  4.1500</span>
<span class="co">#&gt; Block 2 0.00500  0.4050  0.0150  3.5400</span>
<span class="co">#&gt; Block 3 0.01875  0.0075  0.6625  1.0125</span>
<span class="co">#&gt; Block 4 4.12500  3.3900  1.3875     NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">task_blockmodel</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/structblock-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">social_blockmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">blockmodel</a></span><span class="op">(</span><span class="va">m182_social</span>, <span class="va">str_clu</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Network Blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Block membership:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Franklin    Traci    Ronda     Alex   Collin  Kristie   Hannah  Bethany </span>
<span class="co">#&gt;        1        2        3        1        3        3        2        2 </span>
<span class="co">#&gt;    Alton     Bert  Tabitha   Wesley     Lula     Noah   Julius Michelle </span>
<span class="co">#&gt;        1        1        3        1        2        2        1        4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Reduced form blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Franklin Alex Alton Bert Wesley Julius Traci Hannah Bethany Lula Noah Ronda Collin Kristie Tabitha Michelle </span>
<span class="co">#&gt;         Block 1 Block 2 Block 3 Block 4</span>
<span class="co">#&gt; Block 1 2.83500  0.1000  0.2250   1.250</span>
<span class="co">#&gt; Block 2 0.09500  5.2875  0.0825   1.920</span>
<span class="co">#&gt; Block 3 0.24375  0.0750  4.5750   0.075</span>
<span class="co">#&gt; Block 4 0.92500  1.2000  0.3375     NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">social_blockmodel</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/structblock-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">friend_blockmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">blockmodel</a></span><span class="op">(</span><span class="va">m182_friend</span>, <span class="va">str_clu</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Network Blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Block membership:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Franklin    Traci    Ronda     Alex   Collin  Kristie   Hannah  Bethany </span>
<span class="co">#&gt;        1        2        3        1        3        3        2        2 </span>
<span class="co">#&gt;    Alton     Bert  Tabitha   Wesley     Lula     Noah   Julius Michelle </span>
<span class="co">#&gt;        1        1        3        1        2        2        1        4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Reduced form blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Franklin Alex Alton Bert Wesley Julius Traci Hannah Bethany Lula Noah Ronda Collin Kristie Tabitha Michelle </span>
<span class="co">#&gt;           Block 1    Block 2    Block 3 Block 4</span>
<span class="co">#&gt; Block 1 0.6000000 0.03333333 0.04166667       0</span>
<span class="co">#&gt; Block 2 0.1000000 1.00000000 0.10000000       0</span>
<span class="co">#&gt; Block 3 0.3333333 0.15000000 1.16666667       0</span>
<span class="co">#&gt; Block 4 0.0000000 0.00000000 0.00000000     NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">friend_blockmodel</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/structblock-3.png" width="700"></p>
<p>What do these plots show? Plotting the blockmodel like this is particularly useful for characterising what the profile of ties (partners) is for each position/equivalence class. We might characterise them like so:</p>
<ul>
<li>Franklin, Bert, Bethany, Lula, Ronda, Tabitha work together only in reciprocal pairs on tasks, preferring to approach Michelle but also those of the other two roles. While they hang out with each other socially quite a bit, friendship from groups 2 and 3 are preferred. We shall call them <em>freaks</em>.</li>
<li>Alex, Traci, Hannah, Collin, Kristie also work together only in reciprocal pairs, preferring to work collaboratively with group 1 or also Michelle. They also tend to count those from group 1 as friends, and hang out with everyone else but themselves. We shall call them <em>squares</em>.</li>
<li>Alton, Wesley, Julius, Noah will work with either some in group 1 and 3, or 2, but again prefer Michelle for task advice. They are pretty good friends with each other though, and pretty happy to socialise with everyone. We shall call them <em>nerds</em>.</li>
<li>Michelle is a loner, no friends, but everyone hangs out with them for task advice, therefore the <em>geek</em>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="reduced-graph">Reduced graph<a class="anchor" aria-label="anchor" href="#reduced-graph"></a>
</h3>
<p>Finally, we can reduce the graph to just interactions between roles. Let’s start off by graphing the valued/weighted blockmodel.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">group_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Freaks"</span>,<span class="st">"Squares"</span>,<span class="st">"Nerds"</span>,<span class="st">"Geek"</span><span class="op">)</span>
<span class="op">(</span><span class="va">social_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">reduce_graph</a></span><span class="op">(</span><span class="va">social_blockmodel</span>, <span class="va">group_labels</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; IGRAPH 5b4e138 DNW- 4 15 -- </span>
<span class="co">#&gt; + attr: name (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from 5b4e138 (vertex names):</span>
<span class="co">#&gt;  [1] Freaks -&gt;Freaks  Freaks -&gt;Squares Freaks -&gt;Nerds   Freaks -&gt;Geek   </span>
<span class="co">#&gt;  [5] Squares-&gt;Freaks  Squares-&gt;Squares Squares-&gt;Nerds   Squares-&gt;Geek   </span>
<span class="co">#&gt;  [9] Nerds  -&gt;Freaks  Nerds  -&gt;Squares Nerds  -&gt;Nerds   Nerds  -&gt;Geek   </span>
<span class="co">#&gt; [13] Geek   -&gt;Freaks  Geek   -&gt;Squares Geek   -&gt;Nerds</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">social_reduced</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strredgraph-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">task_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">reduce_graph</a></span><span class="op">(</span><span class="va">task_blockmodel</span>, <span class="va">group_labels</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; IGRAPH 755ab8e DNW- 4 14 -- </span>
<span class="co">#&gt; + attr: name (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from 755ab8e (vertex names):</span>
<span class="co">#&gt;  [1] Freaks -&gt;Freaks  Freaks -&gt;Nerds   Freaks -&gt;Geek    Squares-&gt;Freaks </span>
<span class="co">#&gt;  [5] Squares-&gt;Squares Squares-&gt;Nerds   Squares-&gt;Geek    Nerds  -&gt;Freaks </span>
<span class="co">#&gt;  [9] Nerds  -&gt;Squares Nerds  -&gt;Nerds   Nerds  -&gt;Geek    Geek   -&gt;Freaks </span>
<span class="co">#&gt; [13] Geek   -&gt;Squares Geek   -&gt;Nerds</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">task_reduced</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strredgraph-2.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">friend_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">reduce_graph</a></span><span class="op">(</span><span class="va">friend_blockmodel</span>, <span class="va">group_labels</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; IGRAPH e155282 DNW- 4 9 -- </span>
<span class="co">#&gt; + attr: name (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from e155282 (vertex names):</span>
<span class="co">#&gt; [1] Freaks -&gt;Freaks  Freaks -&gt;Squares Freaks -&gt;Nerds   Squares-&gt;Freaks </span>
<span class="co">#&gt; [5] Squares-&gt;Squares Squares-&gt;Nerds   Nerds  -&gt;Freaks  Nerds  -&gt;Squares</span>
<span class="co">#&gt; [9] Nerds  -&gt;Nerds</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">friend_reduced</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/strredgraph-3.png" width="700"></p>
<p>What can help interpreting these profiles is getting the summaries of average weight ties by group.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/census.html">group_tie_census</a></span><span class="op">(</span><span class="va">m182_task</span>, <span class="va">str_clu</span><span class="op">)</span>
<span class="co">#&gt;         fromFranklin fromAlex fromAlton fromBert fromWesley fromJulius</span>
<span class="co">#&gt; Block 1         0.15     0.02      0.00     0.02       0.05       0.02</span>
<span class="co">#&gt; Block 2         0.00     0.42      0.00     0.00       0.03       0.00</span>
<span class="co">#&gt; Block 3         0.07     0.00      0.26     0.00       0.75       0.38</span>
<span class="co">#&gt; Block 4         5.10     4.80      0.30     0.90       1.80       0.90</span>
<span class="co">#&gt;         fromTraci fromHannah fromBethany fromLula fromNoah fromRonda fromCollin</span>
<span class="co">#&gt; Block 1      0.00       0.00        0.55     0.30     0.00       0.6       0.00</span>
<span class="co">#&gt; Block 2      0.33       0.33        0.00     0.00     0.00       0.0       0.39</span>
<span class="co">#&gt; Block 3      0.00       0.00        0.00     0.07     0.60       0.0       0.00</span>
<span class="co">#&gt; Block 4      2.85       2.40        2.40     5.40     1.05       4.5       4.50</span>
<span class="co">#&gt;         fromKristie fromTabitha fromMichelle toFranklin toAlex toAlton toBert</span>
<span class="co">#&gt; Block 1        0.00        0.17         4.12       0.07    0.0    0.00   0.02</span>
<span class="co">#&gt; Block 2        0.15        0.00         3.39       0.00    0.6    0.00   0.00</span>
<span class="co">#&gt; Block 3        0.07        0.00         1.39       0.07    0.0    0.26   0.00</span>
<span class="co">#&gt; Block 4        3.15        6.60         0.00       4.65    4.8    0.75   1.05</span>
<span class="co">#&gt;         toWesley toJulius toTraci toHannah toBethany toLula toNoah toRonda</span>
<span class="co">#&gt; Block 1     0.05     0.05     0.0     0.00      0.55   0.25   0.00    0.68</span>
<span class="co">#&gt; Block 2     0.03     0.03     0.3     0.27      0.00   0.00   0.00    0.00</span>
<span class="co">#&gt; Block 3     0.60     0.45     0.0     0.00      0.00   0.04   0.68    0.00</span>
<span class="co">#&gt; Block 4     2.40     1.20     2.4     1.95      2.85   5.40   1.20    5.25</span>
<span class="co">#&gt;         toCollin toKristie toTabitha toMichelle</span>
<span class="co">#&gt; Block 1     0.00      0.00      0.22       4.15</span>
<span class="co">#&gt; Block 2     0.39      0.06      0.03       3.54</span>
<span class="co">#&gt; Block 3     0.04      0.00      0.00       1.01</span>
<span class="co">#&gt; Block 4     3.90      3.90      5.55       0.00</span></code></pre></div>
<pre><code><span class="co"># ADVANCED: Note on deductive clustering:</span>

<span class="co"># It's pretty straightforward to alter the code above to test hypotheses.</span>
<span class="co"># Simply supply your own cluster vector, where the elements in the vector are in </span>
<span class="co"># the same order as the vertices in the matrix, and the values represent the</span>
<span class="co"># cluster to which each vertex belongs. </span>

  <span class="va">task_social_cors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">task_social</span><span class="op">)</span>
  
<span class="co"># For example, if you believed that actors 2, 7, and 8 formed one group, </span>
<span class="co"># actor 16 former another group, and everyone else formed a third group, </span>
<span class="co"># you could represent this as follows:</span>
<span class="va">dedclust</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>

<span class="co"># Then examine the fitness of this cluster configuration as follows:</span>
<span class="va">dedclust_mat</span> <span class="op">&lt;-</span> <span class="fu">NetCluster</span><span class="fu">::</span><span class="fu">generate_cluster_cor_mat</span><span class="op">(</span><span class="va">task_social_cors</span>, <span class="va">dedclust</span><span class="op">)</span>
<span class="va">dedclust_mat</span>
<span class="fu">gcor</span><span class="op">(</span><span class="va">dedclust_mat</span>, <span class="va">task_social_cors</span><span class="op">)</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="regular-equivalence">Regular Equivalence<a class="anchor" aria-label="anchor" href="#regular-equivalence"></a>
</h2>
<div class="section level3">
<h3 id="constructing-a-triad-census">Constructing a triad census<a class="anchor" aria-label="anchor" href="#constructing-a-triad-census"></a>
</h3>
<p>We’re going to use the same pair of networks as with structural equivalence. But this time we’re not going to get the correlation of ties, but rather the correlation of profiles/patterns of local configurations. How can we identify patterns of local configurations? We’ll measure these profiles in terms of triad counts.</p>
<p>Now, there is a function for calculating triad censuses:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="fu"><a href="../reference/graph_census.html">graph_triad_census</a></span><span class="op">(</span><span class="va">m182_task</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  003  012  102 021D 021U 021C 111D 111U 030T 030C  201 120D 120U 120C  210  300 </span>
<span class="co">#&gt;  133   38  212    2    0    1   14   13    0    0   93    1    0    0   11   42</span></code></pre></div>
<p>But as you can see, it just gives a aggregated tally for the whole network and not one differentiated by actor (which is what we need). Fortunately, <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> offers a node-level triad census too.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># (By putting parentheses around this command, it'll assign AND print!)</span>
<span class="op">(</span><span class="va">task_triads</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/census.html">node_triad_census</a></span><span class="op">(</span><span class="va">m182_task</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;          003 012 102 021D 021U 021C 111D 111U 030T 030C 201 120D 120U 120C 210</span>
<span class="co">#&gt; Franklin  36   9  45    0    0    0    0    1    0    0   3    0    0    0   4</span>
<span class="co">#&gt; Alex      45  10  38    0    0    0    1    1    0    0   1    0    0    0   3</span>
<span class="co">#&gt; Alton     55   0  44    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Bert     102   0   3    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Wesley    55   0  37    0    0    0    2    1    0    0   4    0    0    0   0</span>
<span class="co">#&gt; Julius    65  19  10    0    0    0    5    0    0    0   3    1    0    0   2</span>
<span class="co">#&gt; Traci     91   1  13    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Hannah    91   1  13    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Bethany   90   1  14    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Lula      86   1  18    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Noah      95   0  10    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Ronda     90   1  14    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Collin    93   1  11    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Kristie   90   3  12    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Tabitha   88   2  15    0    0    0    0    0    0    0   0    0    0    0   0</span>
<span class="co">#&gt; Michelle   0   0   0    0    0    0    0    0    0    0  73    0    0    0   6</span>
<span class="co">#&gt;          300</span>
<span class="co">#&gt; Franklin   7</span>
<span class="co">#&gt; Alex       6</span>
<span class="co">#&gt; Alton      6</span>
<span class="co">#&gt; Bert       0</span>
<span class="co">#&gt; Wesley     6</span>
<span class="co">#&gt; Julius     0</span>
<span class="co">#&gt; Traci      0</span>
<span class="co">#&gt; Hannah     0</span>
<span class="co">#&gt; Bethany    0</span>
<span class="co">#&gt; Lula       0</span>
<span class="co">#&gt; Noah       0</span>
<span class="co">#&gt; Ronda      0</span>
<span class="co">#&gt; Collin     0</span>
<span class="co">#&gt; Kristie    0</span>
<span class="co">#&gt; Tabitha    0</span>
<span class="co">#&gt; Michelle  26</span></code></pre></div>
<p>Can you recall what these MAD codes mean? MAN might be easier to remember, for NULL dyads is the last, but MAD is probably more appropriate. <code><a href="https://rdrr.io/pkg/igraph/man/triad_census.html" class="external-link">?igraph::triad.census</a></code> can be used to check what each of the MAD codes means.</p>
<p>As with the structural equivalence, we can simply run our function and return an object that has hierarchically clustered our nodes, but this time it will be based on their (dis)similarity from each others patterns of ties.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cluster.html">cluster_regular_equivalence</a></span><span class="op">(</span><span class="va">m182_task</span><span class="op">)</span>
<span class="fu"><a href="../reference/blockmodel_vis.html">ggtree</a></span><span class="op">(</span><span class="va">reg_res</span>,<span class="fl">4</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/regeq-1.png" width="700"></p>
<p>Ok, so it looks like these nodes are much more similar in terms of their patterns of ties than their actual ties.</p>
<p>Like before, we’ll loop through each possible cluster solution and see how well they match the observed matrix of triad type correlations.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggidentify_clusters</a></span><span class="op">(</span><span class="va">reg_res</span>, <span class="va">task_triads</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/regid-1.png" width="700"></p>
<p>The cluster correlation plot seems a bit ambiguous here, at least visually. But the elbow method has highlighted 2 clusters as a pretty good solution.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/blockmodel_vis.html">ggtree</a></span><span class="op">(</span><span class="va">reg_res</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/cutreereg-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">reg_clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></span><span class="op">(</span><span class="va">reg_res</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Franklin     Alex    Alton     Bert   Wesley   Julius    Traci   Hannah </span>
<span class="co">#&gt;        1        1        1        1        1        1        1        1 </span>
<span class="co">#&gt;  Bethany     Lula     Noah    Ronda   Collin  Kristie  Tabitha Michelle </span>
<span class="co">#&gt;        1        1        1        1        1        1        1        2</span>
<span class="va">m182_task</span> <span class="op">&lt;-</span> <span class="va">m182_task</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/coercion.html">as_tidygraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>regclu <span class="op">=</span> <span class="va">reg_clu</span><span class="op">)</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">m182_task</span>, node_color <span class="op">=</span> <span class="st">"regclu"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Task"</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/cutreereg-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="blockmodelling-1">Blockmodelling<a class="anchor" aria-label="anchor" href="#blockmodelling-1"></a>
</h3>
<p>As before, we can use these clusters to blockmodel the task network.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">task_blockmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">blockmodel</a></span><span class="op">(</span><span class="va">m182_task</span>, <span class="va">reg_clu</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Network Blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Block membership:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Franklin     Alex    Alton     Bert   Wesley   Julius    Traci   Hannah </span>
<span class="co">#&gt;        1        1        1        1        1        1        1        1 </span>
<span class="co">#&gt;  Bethany     Lula     Noah    Ronda   Collin  Kristie  Tabitha Michelle </span>
<span class="co">#&gt;        1        1        1        1        1        1        1        2 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Reduced form blockmodel:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Franklin Alex Alton Bert Wesley Julius Traci Hannah Bethany Lula Noah Ronda Collin Kristie Tabitha Michelle </span>
<span class="co">#&gt;           Block 1 Block 2</span>
<span class="co">#&gt; Block 1 0.1357143    3.11</span>
<span class="co">#&gt; Block 2 3.1500000     NaN</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">task_blockmodel</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/regblock-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="reduced-graph-1">Reduced graph<a class="anchor" aria-label="anchor" href="#reduced-graph-1"></a>
</h3>
<p>Finally, we can reduce the graph to just interactions between roles. Obviously this is not particularly informative with only two clusters though…</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">task_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blockmodel.html">reduce_graph</a></span><span class="op">(</span><span class="va">task_blockmodel</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Regulars"</span>,<span class="st">"Geek"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; IGRAPH b2644f3 DNW- 2 3 -- </span>
<span class="co">#&gt; + attr: name (v/c), weight (e/n)</span>
<span class="co">#&gt; + edges from b2644f3 (vertex names):</span>
<span class="co">#&gt; [1] Regulars-&gt;Regulars Regulars-&gt;Geek     Geek    -&gt;Regulars</span>
<span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">task_reduced</span><span class="op">)</span></code></pre></div>
<p><img src="p5blockmodel_files/figure-html/regredgraph-1.png" width="700"></p>
<p>Finally, we can try to get a sense of what our different clusters represent by generating a cluster-by-triad-type matrix. This is an m x n matrix, where m is the number of clusters and n is the 16 possible triad types. Each cell is the average number of the given triad type for each individual in the cluster:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/census.html">group_triad_census</a></span><span class="op">(</span><span class="va">m182_task</span>, <span class="va">reg_clu</span><span class="op">)</span>
<span class="co">#&gt;           003  012  102 021D 021U 021C 111D 111U 030T 030C   201 120D 120U 120C</span>
<span class="co">#&gt; Block 1 78.13 3.27 19.8    0    0    0 0.53  0.2    0    0  0.73 0.07    0    0</span>
<span class="co">#&gt; Block 2  0.00 0.00  0.0    0    0    0 0.00  0.0    0    0 73.00 0.00    0    0</span>
<span class="co">#&gt;         210   300</span>
<span class="co">#&gt; Block 1 0.6  1.67</span>
<span class="co">#&gt; Block 2 6.0 26.00</span></code></pre></div>
<pre><code><span class="co"># ADVANCED: Note that we can also blockmodel our communities from last week.</span>
<span class="co"># walktrap_blockmodel &lt;- blockmodel(get.adjacency(m182_main, sparse = F), </span>
<span class="co">#                                   friend_wt$membership)</span>
<span class="co"># plot(walktrap_blockmodel)</span>
<span class="co"># walktrap_blockmodel</span>
<span class="co"># # And graphs that from the reduced form blockmodels...</span>
<span class="co"># walktrap_blockmodel_red &lt;- graph.adjacency(walktrap_blockmodel$block.model, weighted = T)</span>
<span class="co"># plot(walktrap_blockmodel_red, edge.width = E(walktrap_blockmodel_red)$weight,</span>
<span class="co">#      vertex.color = rainbow(2) )</span>
<span class="co"># # Admittedly, not terribly interesting...</span>
<span class="co"># </span>
<span class="co"># edgebet_blockmodel &lt;- blockmodel(get.adjacency(m182_main, sparse = F), </span>
<span class="co">#                                  friend_eb$membership)</span>
<span class="co"># plot(edgebet_blockmodel) # blockmodel</span>
<span class="co"># edgebet_blockmodel_red &lt;- graph.adjacency(edgebet_blockmodel$block.model, weighted = T)</span>
<span class="co"># plot(edgebet_blockmodel_red, edge.width=E(edgebet_blockmodel_red)$weight,</span>
<span class="co">#      vertex.color=rainbow(3) ) # reduced graph</span>
<span class="co"># # Cool</span>
<span class="co"># </span>
<span class="co"># fastgreed_blockmodel &lt;- blockmodel(get.adjacency(m182_main, sparse = F), </span>
<span class="co">#                                    friend_fg$membership)</span>
<span class="co"># plot(fastgreed_blockmodel) # blockmodel</span>
<span class="co"># fastgreed_blockmodel_red &lt;- graph.adjacency(fastgreed_blockmodel$block.model, weighted = T)</span>
<span class="co"># plot(fastgreed_blockmodel_red, edge.width=E(fastgreed_blockmodel_red)$weight,</span>
<span class="co">#      vertex.color=rainbow(3) ) # reduced graph</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="unit-test">Unit Test<a class="anchor" aria-label="anchor" href="#unit-test"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Visualise the m182 FRIENDSHIP network, sizing the vertices by constraint and identifying the structural hole What would being in a structural hole mean here?</li>
<li>Plot labelled, reduced graph of REGULARLY equivalent classes on friendship network only</li>
<li>Plot labelled, reduced graph of STRUCTURALLY equivalent classes on task network only</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jameshollway.com" class="external-link">James Hollway</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
