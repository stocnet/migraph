<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>5. Equivalence • migraph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="5. Equivalence">
<meta property="og:description" content="migraph">
<meta property="og:image" content="https://snlab-ch.github.io/migraph/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">migraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Function Overview</a>
</li>
<li>
  <a href="../articles/index.html">Practical Lessons</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/snlab-ch/migraph" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="p5equivalence_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>5. Equivalence</h1>
                        <h4 data-toc-skip class="author">James Hollway</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/snlab-ch/migraph/blob/HEAD/vignettes/p5equivalence.Rmd" class="external-link"><code>vignettes/p5equivalence.Rmd</code></a></small>
      <div class="hidden name"><code>p5equivalence.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="setting-up">Setting up<a class="anchor" aria-label="anchor" href="#setting-up"></a>
</h2>
<p>The data we’re going to use here is included in the <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> package. This dataset is multiplex, meaning that it contains several different types of ties: friendship, social and task interactions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ison_algebra"</span>, package <span class="op">=</span> <span class="st">"migraph"</span><span class="op">)</span></span>
<span><span class="co"># ?migraph::ison_algebra</span></span></code></pre></div>
<p>Note that you do not need to load the package using <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library()</a></code> to get the data. Now you know how to create new matrices in R, load .csv files, saved .RData files, and data from packages!</p>
<div class="section level3">
<h3 id="separating-multiplex-networks">Separating multiplex networks<a class="anchor" aria-label="anchor" href="#separating-multiplex-networks"></a>
</h3>
<p>As a multiplex network, there are actually three different types of tie in this network. We can extract them and investigate them separately using <code><a href="../reference/reformat.html">to_uniplex()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">friends</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"friends"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_graph: 16 nodes and 62 edges</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # A directed simple graph with 3 components</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span><span class="co">#&gt;   name    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 Melinda </span></span>
<span><span class="co">#&gt; 2 Abby    </span></span>
<span><span class="co">#&gt; 3 Darryl  </span></span>
<span><span class="co">#&gt; 4 Veronica</span></span>
<span><span class="co">#&gt; 5 Rylan   </span></span>
<span><span class="co">#&gt; 6 Lindsey </span></span>
<span><span class="co">#&gt; # … with 10 more rows</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Edge Data: 62 × 3</span></span>
<span><span class="co">#&gt;    from    to weight</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     2     1      1</span></span>
<span><span class="co">#&gt; 2     2     7      1</span></span>
<span><span class="co">#&gt; 3     2     8      1</span></span>
<span><span class="co">#&gt; # … with 59 more rows</span></span>
<span><span class="va">gfriend</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">friends</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Friendship"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">social</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"social"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_graph: 16 nodes and 129 edges</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # A directed simple graph with 1 component</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span><span class="co">#&gt;   name    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 Melinda </span></span>
<span><span class="co">#&gt; 2 Abby    </span></span>
<span><span class="co">#&gt; 3 Darryl  </span></span>
<span><span class="co">#&gt; 4 Veronica</span></span>
<span><span class="co">#&gt; 5 Rylan   </span></span>
<span><span class="co">#&gt; 6 Lindsey </span></span>
<span><span class="co">#&gt; # … with 10 more rows</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Edge Data: 129 × 3</span></span>
<span><span class="co">#&gt;    from    to weight</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     5   1.2 </span></span>
<span><span class="co">#&gt; 2     1     8   0.15</span></span>
<span><span class="co">#&gt; 3     1     9   2.85</span></span>
<span><span class="co">#&gt; # … with 126 more rows</span></span>
<span><span class="va">gsocial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">social</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Social"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">tasks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reformat.html">to_uniplex</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="st">"tasks"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_graph: 16 nodes and 88 edges</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # A directed simple graph with 1 component</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Node Data: 16 × 1 (active)</span></span>
<span><span class="co">#&gt;   name    </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   </span></span>
<span><span class="co">#&gt; 1 Melinda </span></span>
<span><span class="co">#&gt; 2 Abby    </span></span>
<span><span class="co">#&gt; 3 Darryl  </span></span>
<span><span class="co">#&gt; 4 Veronica</span></span>
<span><span class="co">#&gt; 5 Rylan   </span></span>
<span><span class="co">#&gt; 6 Lindsey </span></span>
<span><span class="co">#&gt; # … with 10 more rows</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Edge Data: 88 × 3</span></span>
<span><span class="co">#&gt;    from    to weight</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     5    0.3</span></span>
<span><span class="co">#&gt; 2     1     9    0.3</span></span>
<span><span class="co">#&gt; 3     1    10    0.3</span></span>
<span><span class="co">#&gt; # … with 85 more rows</span></span>
<span><span class="va">gtask</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">tasks</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Task"</span><span class="op">)</span></span>
<span><span class="va">gfriend</span> <span class="op">+</span> <span class="va">gsocial</span> <span class="op">+</span> <span class="va">gtask</span></span></code></pre></div>
<div class="figure">
<img src="teaching/separatingnets-1.png" alt=""><p class="caption">plot of chunk separatingnets</p>
</div>
<p>Note also that these are weighted networks. <code><a href="../reference/autographr.html">autographr()</a></code> automatically registers these different weights and plots them.</p>
</div>
</div>
<div class="section level2">
<h2 id="structural-holes-and-constraint">Structural Holes and Constraint<a class="anchor" aria-label="anchor" href="#structural-holes-and-constraint"></a>
</h2>
<p>Where might innovation be most likely to occur in these networks? Let’s take a look at which actors are least constrained by their position in the task network to begin with. <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> makes this easy enough with the <code><a href="../reference/holes.html">node_constraint()</a></code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/holes.html">node_constraint</a></span><span class="op">(</span><span class="va">tasks</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Melinda  Abby Darryl Veron…¹ Rylan Lindsey  Lula  Elva</span></span>
<span><span class="co">#&gt; 1   0.930 0.877  0.664   0.987 0.611   0.609 0.900 0.894</span></span>
<span><span class="co">#&gt; # ... with 8 more from this nodeset in the vector.</span></span></code></pre></div>
<p>We see that this function returns a vector of constraint scores that can range between 0 and 1. Let’s size the nodes according to this score, and identify the node with the minimum constraint score.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tasks</span> <span class="op">&lt;-</span> <span class="va">tasks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>low_constraint <span class="op">=</span> <span class="fu"><a href="../reference/mark_nodes.html">node_is_min</a></span><span class="op">(</span><span class="fu"><a href="../reference/holes.html">node_constraint</a></span><span class="op">(</span><span class="va">tasks</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">tasks</span>, node_color <span class="op">=</span> <span class="st">"low_constraint"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/constraintplot-1.png" alt=""><p class="caption">plot of chunk constraintplot</p>
</div>
<p>Why minimum? And what can we learn from this plot about where innovation might occur within this network?</p>
</div>
<div class="section level2">
<h2 id="structural-equivalence">Structural Equivalence<a class="anchor" aria-label="anchor" href="#structural-equivalence"></a>
</h2>
<p>Now we are going to identify and interpret the roles or relations between a set of structurally equivalent positions. We’re going to identify structurally equivalent positions across all the data that we have, including ‘task’, ‘social’, and ‘friend’ ties.</p>
<div class="section level3">
<h3 id="finding-structurally-equivalent-classes">Finding structurally equivalent classes<a class="anchor" aria-label="anchor" href="#finding-structurally-equivalent-classes"></a>
</h3>
<p>In <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>, finding how the nodes of a network can be partitioned into structurally equivalent classes is as easy as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1 </span></span>
<span><span class="co">#&gt;    Melinda, Veronica, Miriam, George, Dustin, Marsha</span></span>
<span><span class="co">#&gt;  2 </span></span>
<span><span class="co">#&gt;    Abby, Lula, Elva, Colleen, Ezra</span></span>
<span><span class="co">#&gt;  3 </span></span>
<span><span class="co">#&gt;    Darryl, Rylan, Lindsey, Luella</span></span>
<span><span class="co">#&gt;  4 </span></span>
<span><span class="co">#&gt;    Diane</span></span>
<span><span class="va">ison_algebra</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span>node_color <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/find-se-1.png" alt=""><p class="caption">plot of chunk find-se</p>
</div>
<p>But actually, a lot is going on behind the scenes here that we can unpack.</p>
</div>
<div class="section level3">
<h3 id="step-one-starting-with-a-census">Step one: starting with a census<a class="anchor" aria-label="anchor" href="#step-one-starting-with-a-census"></a>
</h3>
<p>All equivalence classes are based on nodes’ similarity across some profile of motifs. In <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>, we call these motif censuses. Any kind of census can be used, and <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> includes a few options, but <code><a href="../reference/equivalence.html">node_structural_equivalence()</a></code> is based off of the census of all the nodes’ ties, both outgoing and incoming ties, to reveal their relationships to tie partners.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/node_census.html">node_tie_census</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 16 × 96</span></span>
<span><span class="co">#&gt;    fromMelinda…¹ fromA…² fromD…³ fromV…⁴ fromR…⁵ fromL…⁶</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1             0       1       0       0       1       1</span></span>
<span><span class="co">#&gt;  2             0       0       0       0       0       0</span></span>
<span><span class="co">#&gt;  3             0       0       0       0       1       2</span></span>
<span><span class="co">#&gt;  4             0       0       0       0       0       0</span></span>
<span><span class="co">#&gt;  5             0       0       1       0       0       1</span></span>
<span><span class="co">#&gt;  6             0       0       1       0       1       0</span></span>
<span><span class="co">#&gt;  7             0       1       0       0       0       1</span></span>
<span><span class="co">#&gt;  8             0       1       0       0       1       0</span></span>
<span><span class="co">#&gt;  9             0       0       0       0       0       0</span></span>
<span><span class="co">#&gt; 10             0       0       0       0       1       1</span></span>
<span><span class="co">#&gt; 11             0       0       1       0       2       1</span></span>
<span><span class="co">#&gt; 12             0       0       0       0       0       1</span></span>
<span><span class="co">#&gt; 13             0       2       0       0       0       0</span></span>
<span><span class="co">#&gt; 14             0       1       1       0       0       0</span></span>
<span><span class="co">#&gt; 15             0       0       1       0       0       0</span></span>
<span><span class="co">#&gt; 16             0       0       0       0       0       0</span></span>
<span><span class="co">#&gt; # … with 90 more variables: fromLula_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromElva_friends &lt;dbl&gt;, fromMiriam_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromGeorge_friends &lt;dbl&gt;, fromLuella_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromDustin_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromColleen_friends &lt;dbl&gt;, fromEzra_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromMarsha_friends &lt;dbl&gt;, fromDiane_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   toMelinda_friends &lt;dbl&gt;, toAbby_friends &lt;dbl&gt;, …</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/node_census.html">node_tie_census</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 16 96</span></span></code></pre></div>
<p>We can see that the result is a matrix of 16 rows and 96 columns, because we want to catalogue or take a census of all the different incoming/outgoing partners our 16 nodes might have across these three networks. Note also that the result is a weighted matrix; what would you do if you wanted it to be binary?</p>
<p>Note that <code><a href="../reference/node_census.html">node_tie_census()</a></code> does not need to be passed to <code><a href="../reference/equivalence.html">node_structural_equivalence()</a></code> — this is done automatically — but the more generic <code><a href="../reference/equivalence.html">node_equivalence()</a></code> can be used with whichever tie census is desired. Feel free to explore using some of the other censuses available in <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>, though some common ones are already used in the other equivalence convenience functions, <code><a href="../reference/equivalence.html">node_regular_equivalence()</a></code> and <code><a href="../reference/equivalence.html">node_automorphic_equivalence()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="step-two-growing-a-tree-of-similarity">Step two: growing a tree of similarity<a class="anchor" aria-label="anchor" href="#step-two-growing-a-tree-of-similarity"></a>
</h3>
<p>The next part is all done internally, though there are several important parameters that can be set to obtain different results.</p>
<p>There are two main parameters that can be set here. First, users can set the type of distance measure used. This is passed on to <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code>, so that help page should be consulted for more details. By default <code>"euclidean"</code> is used.</p>
<p>Second, we can also set the type of clustering algorithm employed. By default, <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>’s equivalence functions use hierarchical clustering, <code>"hier"</code>, but for compatibility and enthusiasts, we also offer <code>"concor"</code>, which implements a CONCOR (CONvergence of CORrelations) algorithm.</p>
<p>We can see the difference from varying the clustering algorithm and/or distance by plotting the dendrograms (hidden) in the output from <code><a href="../reference/equivalence.html">node_structural_equivalence()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, cluster <span class="op">=</span> <span class="st">"hier"</span>, distance <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/vary-clust-1.png" alt=""><p class="caption">plot of chunk vary-clust</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, cluster <span class="op">=</span> <span class="st">"hier"</span>, distance <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/vary-clust-2.png" alt=""><p class="caption">plot of chunk vary-clust</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, cluster <span class="op">=</span> <span class="st">"concor"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/vary-clust-3.png" alt=""><p class="caption">plot of chunk vary-clust</p>
</div>
<p>So plotting a <code>membership</code> vector from <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> returns a dendrogram with the names of the nodes on the <em>y</em>-axis and the distance between them on the <em>x</em>-axis. Using the census as material, the distances between the nodes is used to create a dendrogram of (dis)similarity among the nodes. Basically, as we move to the right, we’re allowing for more and more dissimilarity among those we cluster together. A fork or branching point indicates the level of dissimilarity at which those two or more nodes would be said to be equivalent. Where two nodes’ branches join/fork is the distance between them, so more similar nodes’ branches fork closer to the tree’s canopy, and less similar (groups of) nodes don’t join until basically they form a trunk.</p>
<p>Note that with the results using the hierarchical clustering algorithm, the distance directly affects the structure of the tree (and the results).</p>
<p>The CONCOR dendrogram is a bit different though. Instead it represents how converging correlations repreatedly bifurcate the nodes into one of two partitions. As such the ‘distance’ is really just the (inverse) number of steps of bifurcations until nodes belong to the same class.</p>
</div>
<div class="section level3">
<h3 id="step-three-identifying-the-number-of-clusters">Step three: identifying the number of clusters<a class="anchor" aria-label="anchor" href="#step-three-identifying-the-number-of-clusters"></a>
</h3>
<p>Another bit of information represented in the dendrogram is where the tree should be cut (the dashed red line) and how the nodes are assigned to the branches (clusters) present at that cut-point.</p>
<p>But where does this red line come from? Or, more technically, how do we identify the number of clusters into which to assign nodes?</p>
<p><a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> includes several different ways of establishing <code>k</code>, or the number of clusters. Remember, the further to the right the red line is (the lower on the tree the cut point is) the more dissimilar we’re allowing nodes in the same cluster to be. We could set this ourselves by just passing <code>k</code> an integer.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/k-discrete-1.png" alt=""><p class="caption">plot of chunk k-discrete</p>
</div>
<p>But we’re really just guessing. Maybe 2 is not the best <code>k</code>? To establish that, we need to iterate through a number of potential <code>k</code>, and consider their fitness by some metric. There are a couple of options here.</p>
<p>One is to consider, for each <code>k</code>, how correlated this partition is with the observed network. When there is one cluster for each vertex in the network, cell values will be identical to the observed correlation matrix, and when there is one cluster for the whole network, the values will all be equal to the average correlation across the observed matrix. So the correlations in each by-cluster matrix are correlated with the observed correlation matrix to see how well each by-cluster matrix fits the data.</p>
<p>Of course, the perfect partition would then be where all nodes are in their own cluster, which is hardly ‘clustering’ at all. Also, increasing <code>k</code> will always improve the correlation. But if one were to plot these correlations as a line graph, then we might expect there to be a relatively rapid increase in correlation as we move from, for example, 3 clusters to 4 clusters, but a relatively small increase from, for example, 13 clusters to 14 clusters. By identifying the inflection point in this line graph, <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> selects a number of clusters that represents a trade-off between fit and parsimony. This is the <code>k = "elbow"</code> method.</p>
<p>The other option is to evaluate a candidate for <code>k</code> based not on correlation but on a metric of how similar each node in a cluster is to others in its cluster <em>and</em> how dissimilar each node is to those in a neighbouring cluster. When averaged over all nodes and all clusters, this provides a ‘silhouette coefficient’ for a candidate of <code>k</code>. Choosing the number of clusters that maximizes this coefficient, which is what <code>k = "silhouette"</code> does, can return a somewhat different result to the elbow method. See what we have here, with all other arguments held the same:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, k <span class="op">=</span> <span class="st">"elbow"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/elbowsil-1.png" alt=""><p class="caption">plot of chunk elbowsil</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, k <span class="op">=</span> <span class="st">"silhouette"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/elbowsil-2.png" alt=""><p class="caption">plot of chunk elbowsil</p>
</div>
<p>Ok, so it looks like the elbow method returns <code>k == 3</code> as a good trade-off between fit and parsimony. The silhouette method, by contrast, sees <code>k == 4</code> as maximising cluster similarity and dissimilarity. Either is probably fine here, and there is much debate around how to select the number of clusters anyway, but the silhouette method seems to do a better job of identifying how unique Diane is. The silhouette method is also the default in <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a>.</p>
<p>Note that there is a somewhat hidden parameter here, <code>range</code>. Since testing across all possible numbers of clusters can get computationally expensive (not to mention uninterpretable) for large networks, <a href="https://github.com/snlab-ch/migraph" class="external-link">migraph</a> only considers up to 8 clusters by default. This however can be modified to be higher or lower, e.g. <code>range = 16</code>.</p>
<p>Finally, one last option is <code>k = "strict"</code>, which only assigns nodes to the same partition if there is a distance of zero between them. This is quick and rigorous solution, however oftentimes this misses the point in finding clusters of nodes that, despite some variation, can be considered as similar on some dimension.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span>, k <span class="op">=</span> <span class="st">"strict"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/strict-1.png" alt=""><p class="caption">plot of chunk strict</p>
</div>
<p>Here for example, no two nodes have precisely the same tie-profile, otherwise their branches would join/fork at a distance of 0. As such, <code>k = "strict"</code> partitions the network into 16 clusters. Where networks have a number of nodes with strictly the same profiles, such a k-selection method might be helpful to recognise those in exactly the same structural position, but here it essentially just reports nodes’ identity.</p>
</div>
</div>
<div class="section level2">
<h2 id="blockmodelling">Blockmodelling<a class="anchor" aria-label="anchor" href="#blockmodelling"></a>
</h2>
<div class="section level3">
<h3 id="summarising-profiles">Summarising profiles<a class="anchor" aria-label="anchor" href="#summarising-profiles"></a>
</h3>
<p>Ok, so now we have a result from establishing nodes’ membership in structurally equivalent classes. We can graph this of course, as above:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">str_clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span></span>
<span><span class="va">ison_algebra</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span>node_color <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/strplot-1.png" alt=""><p class="caption">plot of chunk strplot</p>
</div>
<p>While this plot enters the class information in to our earlier graph, it doesn’t always help us understand how the classes vary.</p>
<p>One option that can be useful for characterising what the profile of ties (partners) is for each position/equivalence class is to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. Used on a <code>node_motif</code> object, it also expects some membership vector, and then it summarises the census by the partition assignment. By default it takes the average of ties (values), but this can be tweaked by assigning some other summary statistic as <code>FUN =</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/node_census.html">node_tie_census</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span>,</span>
<span>        membership <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 96</span></span>
<span><span class="co">#&gt;   fromMelinda_…¹ fromA…² fromD…³ fromV…⁴ fromR…⁵ fromL…⁶</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1              0   0.167   0.167       0   0.333     0.5</span></span>
<span><span class="co">#&gt; 2              0   1       0.2         0   0.2       0.2</span></span>
<span><span class="co">#&gt; 3              0   0       0.75        0   1         1  </span></span>
<span><span class="co">#&gt; 4              0   0       0           0   0         0  </span></span>
<span><span class="co">#&gt; # … with 90 more variables: fromLula_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromElva_friends &lt;dbl&gt;, fromMiriam_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromGeorge_friends &lt;dbl&gt;, fromLuella_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromDustin_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromColleen_friends &lt;dbl&gt;, fromEzra_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   fromMarsha_friends &lt;dbl&gt;, fromDiane_friends &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   toMelinda_friends &lt;dbl&gt;, toAbby_friends &lt;dbl&gt;, …</span></span></code></pre></div>
<p>Since this node census produces 96 columns, <span class="math inline">\(16 \text{nodes} * 2 \text{directions} * 3 \text{edge types}\)</span>, it takes a bit to look through what varies between the different classes as ‘blocked’.</p>
<p>Another way to do this is to plot the blockmodel as a whole. Passing the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function an adjacency/incidence matrix along with a membership vector allows the matrix to be sorted and framed (without the membership vector, just the adjacency/incidence matrix is plotted):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/as.html">as_matrix</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span>,</span>
<span>     membership <span class="op">=</span> <span class="va">str_clu</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/block-1.png" alt=""><p class="caption">plot of chunk block</p>
</div>
<p>So, with this information, we might characterise them like so:</p>
<ul>
<li>Melinda, Veronica, Miriam, George, Dustin, Marsha work together only in reciprocal pairs on tasks, preferring to approach Diane but also those of the other two roles. While they hang out with each other socially quite a bit, friendship from groups 2 and 3 are preferred. We shall call them <em>freaks</em>.</li>
<li>Abby, Lula, Elva, Colleen, Ezra also work together only in reciprocal pairs, preferring to work collaboratively with group 1 or also Diane. They also tend to count those from group 1 as friends, and hang out with everyone else but themselves. We shall call them <em>squares</em>.</li>
<li>Darryl, Rylan, Lindsey, Luella will work with either some in group 1 and 3, or 2, but again prefer Diane for task advice. They are pretty good friends with each other though, and pretty happy to socialise with everyone. We shall call them <em>nerds</em>.</li>
<li>Diane is a loner, no friends, but everyone hangs out with them for task advice, therefore the <em>geek</em>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="reduced-graph">Reduced graph<a class="anchor" aria-label="anchor" href="#reduced-graph"></a>
</h3>
<p>Lastly, we can consider how <em>classes</em> of nodes relate to one another in a blockmodel. Let’s use the 4-cluster solution on the valued network (though binary is possible too).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">str_clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/equivalence.html">node_structural_equivalence</a></span><span class="op">(</span><span class="va">ison_algebra</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transform.html">to_blocks</a></span><span class="op">(</span><span class="va">ison_algebra</span>, <span class="va">str_clu</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tbl_graph: 4 nodes and 15 edges</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # A directed multigraph with 1 component</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Node Data: 4 × 1 (active)</span></span>
<span><span class="co">#&gt;   name   </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;  </span></span>
<span><span class="co">#&gt; 1 Block 1</span></span>
<span><span class="co">#&gt; 2 Block 2</span></span>
<span><span class="co">#&gt; 3 Block 3</span></span>
<span><span class="co">#&gt; 4 Block 4</span></span>
<span><span class="co">#&gt; #</span></span>
<span><span class="co">#&gt; # Edge Data: 15 × 3</span></span>
<span><span class="co">#&gt;    from    to weight</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1     1  0.611</span></span>
<span><span class="co">#&gt; 2     1     2  0.267</span></span>
<span><span class="co">#&gt; 3     1     3  0.417</span></span>
<span><span class="co">#&gt; # … with 12 more rows</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="va">bm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">as_tidygraph</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Freaks"</span>, <span class="st">"Squares"</span>, <span class="st">"Nerds"</span>, <span class="st">"Geek"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/autographr.html">autographr</a></span><span class="op">(</span><span class="va">bm</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="teaching/structblock-1.png" alt=""><p class="caption">plot of chunk structblock</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="unit-test">Unit Test<a class="anchor" aria-label="anchor" href="#unit-test"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Plot labelled, reduced graph of STURCTURALLY equivalent classes on the <code>mpn_elite_usa_advice</code> network and interpret</p></li>
<li><p>Plot labelled, reduced graph of REGULARLY equivalent classes on the <code>mpn_elite_usa_advice</code> network and interpret</p></li>
<li><p>Plot labelled, reduced graph of AUTOMORPHICALLY equivalent classes on the <code>mpn_elite_usa_advice</code> network only and interpret</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://jameshollway.com" class="external-link">James Hollway</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
